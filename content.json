{"meta":{"title":"å¤§åŠ›","subtitle":"å‡ºå¥‡è¿¹","description":"Dali|å¤§åŠ›|åšå®¢|ä¸ªäºº","author":"å¤§åŠ›","url":"http://dali.com","root":"/"},"posts":[{"tags":[],"title":"Hello World","date":"2022/06/12","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick Start Create a new post 1$ hexo new \"My New Post\" More info: Writing Run server 1$ hexo server More info: Server Generate static files 1$ hexo generate More info: Generating Deploy to remote sites 1$ hexo deploy More info: Deployment","permalink":"http://dali.com/2022/06/12/Helloworld/","photos":[]},{"tags":[],"title":"å‰ç«¯æ€§èƒ½ç›‘æ§","date":"2022/04/03","text":"ä¸ºä»€ä¹ˆéœ€è¦æ€§èƒ½ç›‘æ§ æ‹¥æœ‰ç»Ÿä¸€çš„æŒ‡æ ‡ï¼ˆæ ‡å‡†ï¼‰æ¥è¡¡é‡æˆ‘ä»¬é¡µé¢çš„ä¸€ä¸ªæ¸²æŸ“ã€äº¤äº’æƒ…å†µ éšç€ä¸šåŠ¡æˆ–è€…æŠ€æœ¯çš„å‘å±•ï¼Œæˆ‘ä»¬å¯¹åŸºç¡€æ¶æ„çš„å‡çº§ï¼šæ¯”å¦‚è¯´æ¥å…¥äº†node-ssrï¼Œå‡çº§äº†webpackçš„æ‰“åŒ…ç­–ç•¥ï¼Œä½¿ç”¨workbox)ï¼Œè¿™äº›æ”¹é€ å¯¹äºæˆ‘ä»¬çš„æˆ‘ä»¬å½“å‰é¡µé¢çš„å½±å“ æ€§èƒ½ç›‘æµ‹ä»æŠ€æœ¯ä¾§æ›´å¥½çš„ä¼˜åŒ–é¡µé¢ï¼Œæé«˜pvç‡ï¼Œæé«˜ç”¨æˆ·ä½“éªŒ å·¥å…· å¼€å‘è€…é¢æ¿ lighthouse webpagetest åŸºæœ¬æ¡†æ¶ PerformanceObserver()ï¼š å¼‚æ­¥çš„ performance.timing : åŒæ­¥çš„æ—¶é—´ï¼Œç™½å±çš„æ—¶é—´ï¼Œdnsçš„æ¡æ‰‹ caniuse-lit å¯¹apiæ”¯æŒåº¦çš„åŒ… åˆå§‹åŒ–å‚æ•° 1234567new SDk({ logUrl: string // ä¸ŠæŠ¥åœ°å€ isResourceTimingï¼š analyticsTrackerï¼š isElementTimingï¼š maxTimeï¼š }) TTFB TTFB = é‡å®šå‘æ—¶é—´ + servicework + dnsæŸ¥è¯¢+ tcp + responseStart onload æˆ–è€… document.readyState === â€˜completeâ€™ åï¼ŒåŠ å…¥åˆ°å®ä»»åŠ¡ 123addEventListener('load', () =&gt; setTimeout(()=&gt; {const value = performance.getEntriesByType('navigation')[0].responseStart}, 0)); å¼‚å¸¸æ•°æ®ç¦æ­¢ä¸ŠæŠ¥ï¼š 123if (metric.value &lt; 0 || metric.value &gt; performance.now()) { return} é€šç”¨çš„observe 12345678910111213141516export const po = ( eventType: IPerformanceObserverType, cb: (performanceEntries: any[]) =&gt; void): PerformanceObserver | null =&gt; { try { const perfObserver = new PerformanceObserver((entryList) =&gt; { cb(entryList.getEntries()); }); // è®¢é˜…æ—¶é—´æˆ–è€…å¼€å§‹è®¡æ—¶ bufferedä¸ç«‹å³æ‰§è¡Œåœ¨å†…å­˜ä¸­ç•™ä¸‹PerformanceObserverå®ä¾‹ perfObserver.observe({ type: eventType, buffered: true }); return perfObserver; } catch (e) { C.warn('ç›‘æ§error:', e); } return null;}; fcpã€fp 12345678910111213141516po('paint', initFirstPaint)export const initFirstPaint = (performanceEntries: IPerformanceEntry[]) =&gt; { performanceEntries.forEach((entry) =&gt; { if (entry.name === 'first-paint') { console.log('é¦™è•‰ğŸŒ--ã€‹', performanceEntries) logMetric(entry.startTime, 'fp'); } else if (entry.name === fcpEntryName) { fcp.value = entry.startTime; logMetric(fcp.value, 'fcp'); // TBT æ˜¯fcpåˆ°ttiä¸­é—´çš„è¶…è¿‡50msçš„é•¿ä»»åŠ¡çš„æ€»å’Œ perfObservers[4] = po('longtask', initTotalBlockingTime); // å»é™¤è¿æ¥ poDisconnect(0); } });}; tbt fcpåˆ°ttiä¹‹é—´ä¹‹é—´é•¿ä»»åŠ¡çš„æ—¶é—´æ€»å’Œ æ³¨æ„ç‚¹ï¼š ä¸ç»Ÿè®¡æµè§ˆå™¨æœ¬èº«çš„ äº‹ä»¶å¾ªç¯æœ¬èº« https://w3c.github.io/longtasks/ 12345678910111213141516 po('longtask', initTotalBlockingTime); initTotalBlockingTime = ( performanceEntries: IPerformanceEntry[]): void =&gt; { performanceEntries.forEach((entry) =&gt; { //ä»fcp -&gt; ttiè·å–é•¿è€—æ—¶ä»»åŠ¡ï¼ˆselfè¡¨ç¤ºè€—æ—¶é•¿ä»»åŠ¡æ¥è‡ªäºæ¸²æŸ“å¸§ï¼‰ if (entry.name !== 'self' || entry.startTime &lt; fcp.value) { return; } //é•¿è€—æ—¶ä»»åŠ¡æ„å‘³ç€æ‰§è¡Œæ—¶é—´è¶…è¿‡50msçš„ const blockingTime = entry.duration - 50; if (blockingTime &gt; 0) { tbt.value += blockingTime; } });}; // ä½•æ—¶ä¸ŠæŠ¥: åœ¨fidæŒ‡æ ‡è·å–å 1234setTimeout(() =&gt; { logMetric(tbt.value, `tbt5S`); }, 0); fidï¼ˆç¬¬ä¸€æ¬¡è¾“å…¥å»¶è¿Ÿï¼‰ FID æµ‹é‡ä»ç”¨æˆ·ç¬¬ä¸€æ¬¡ä¸é¡µé¢äº¤äº’ï¼ˆä¾‹å¦‚å½“ä»–ä»¬å•å‡»é“¾æ¥ã€ç‚¹æŒ‰æŒ‰é’®æˆ–ä½¿ç”¨ç”± JavaScript é©±åŠ¨çš„è‡ªå®šä¹‰æ§ä»¶ï¼‰ç›´åˆ°æµè§ˆå™¨å¯¹äº¤äº’ä½œå‡ºå“åº”ï¼Œå¹¶å®é™…èƒ½å¤Ÿå¼€å§‹å¤„ç†äº‹ä»¶å¤„ç†ç¨‹åºæ‰€ç»è¿‡çš„æ—¶é—´ã€‚ å®é™…å‘ç”Ÿçš„è¡Œä¸ºï¼Œåªèƒ½æ ¹æ®å“åº”çš„æ—¶é—´è¿›è¡Œ 1234567891011121314151617 po('first-input', initFirstInputDelay); const initFirstInputDelay = ( performanceEntries: PerformanceEventTiming[]) =&gt; { //å–æœ€åçš„ä¸€ä½å³ä¸ºæˆ‘ä»¬å¸Œæœ›æ‰€è·å–çš„æ—¶é—´ç‚¹ console.log('ghahhahahha--&gt;', performanceEntries) const lastEntry = performanceEntries.pop(); if (lastEntry) { // Core Web Vitals FID logic // æµ‹é‡è¾“å…¥äº‹ä»¶çš„å»¶è¿Ÿæ“ä½œ logMetric(lastEntry.processingStart - lastEntry.startTime, 'fidVitals', { performanceEntry: lastEntry, }); } // é”€æ¯å¯¹FIDçš„æ³¨å†Œå›è°ƒ é¿å…è¿‡å¤šçš„è§‚å¯Ÿè€…é€ æˆå†…å­˜æ³„éœ² poDisconnect(1);} ä½•æ—¶ä¸ŠæŠ¥: åœ¨fidæŒ‡æ ‡è·å–å lcp å½“ç”¨æˆ·ä¸é¡µé¢è¿›è¡Œäº¤äº’ï¼ˆé€šè¿‡è½»è§¦ã€æ»šåŠ¨æˆ–æŒ‰é”®ï¼‰æ—¶ï¼Œæµè§ˆå™¨å°†ç«‹åˆ»åœæ­¢æŠ¥å‘Šæ–°æ¡ç›®ï¼Œå› ä¸ºç”¨æˆ·äº¤äº’é€šå¸¸ä¼šæ”¹å˜ç”¨æˆ·å¯è§çš„å†…å®¹ï¼ˆæ»šåŠ¨æ“ä½œæ—¶å°¤å…¶å¦‚æ­¤ï¼‰ 12345678export const initLargestContentfulPaint = ( performanceEntries: IPerformanceEntry[]) =&gt; { const lastEntry = performanceEntries.pop(); if (lastEntry) { lcp.value = lastEntry.renderTime || lastEntry.loadTime; }}; èµ„æºç›‘æ§ po(â€˜resourceâ€™, initResourceTiming); layout-shift https://developer.mozilla.org/en-US/docs/Web/API/LayoutShift hadRecentInput: 500mså†…ç”¨æˆ·è¾“å…¥å¯¼è‡´çš„ä½ç§»ä¸è®¡å…¥æ„å¤–ä½ç§» 123456export const initLayoutShift = (performanceEntries: IPerformanceEntry[]) =&gt; { const lastEntry = performanceEntries.pop(); if (lastEntry &amp;&amp; !lastEntry.hadRecentInput &amp;&amp; lastEntry.value) { cls.value += lastEntry.value; }}; ä¸ŠæŠ¥å·¥å…· imgçš„src sendBeach ä½•æ—¶ä¸Šä¼  pageshow pagehide window.requestAnimationFrame window.requestIdleCallback ç”¨æˆ·ç¦»çº¿äº† æ•°æ®æ— æ³•ä¸ŠæŠ¥ offline.js æºç  æˆ‘çš„æºç é“¾æ¥ï¼Œæ¬¢è¿fork","permalink":"http://dali.com/2022/04/03/%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7/","photos":[]}],"categories":[],"tags":[]}